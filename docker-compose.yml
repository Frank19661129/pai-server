services:
  claudine-server:
    container_name: claudine-server
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "8003:8000"  # Main server port (external:internal)
    env_file:
      - .env
    environment:
      - DATABASE_URL=postgresql://claudine:claudine_dev_password@claudine-postgres:5432/claudine
      - DEBUG=true
      - SECRET_KEY=${SECRET_KEY:-dev-secret-key-change-in-production}
    volumes:
      - ./app:/app/app  # Mount app directory for development hot-reload
    restart: unless-stopped
    networks:
      - postgres_network
      - mcp_network

networks:
  postgres_network:
    name: server-v0_claudine_network
    external: true
  mcp_network:
    name: claudine_claudine-mcp-network
    external: true

# Notes:
# - Uses existing claudine-postgres container from server-v0
# - Creates claudine_v1 database if it doesn't exist
# - Port 8003 for main server
# - Hot-reload enabled via volume mount for development
# - Connected to MCP network for communication with MCP servers
